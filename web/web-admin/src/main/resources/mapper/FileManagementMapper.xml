<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.atguigu.lease.web.admin.mapper.FileManagementMapper">

    <!-- 查询过期的临时文件 -->
    <select id="selectExpiredTempFiles" resultType="com.atguigu.lease.model.entity.FileManagement">
        SELECT * FROM file_management
        WHERE status = 0
          AND create_time &lt; #{expireTime}
          AND is_deleted = 0
    </select>

    <!-- 批量更新文件状态 -->
    <update id="batchUpdateStatus">
        UPDATE file_management
        SET status = 1,
        business_type = #{businessType},
        business_id = #{businessId},
        update_time = NOW()
        WHERE id IN
        <foreach collection="ids" item="id" open="(" separator="," close=")">
            #{id}
        </foreach>
    </update>

</mapper>
